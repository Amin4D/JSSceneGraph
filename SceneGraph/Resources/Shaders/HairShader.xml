<?xml version="1.0" encoding="UTF-8"?>
<shader>
	<name>HairMaterial</name>
	<uniforms>
		<uniform name="u_lightPosition" constant="lightPosition" owner="light"/>
		<uniform name="u_modelViewProjectionMatrix" constant="modelViewProjectionMatrix" owner="instance"/>
		<uniform name="u_modelViewMatrix" constant="modelViewMatrix"  owner="instance"/>
		<uniform name="u_materialSpecularColor" constant="specularColor" defaultValue="FABRIC.RT.rgba(1.0,1.0,0.8,1.0)"/>
	</uniforms>
	<attributes>
		<attribute name="a_position" binding="positions"/>
		<attribute name="a_color" binding="vertexColors"/>
	</attributes>
	
	<vertexshader>
		<source>
			uniform mat4 u_modelViewProjectionMatrix;
			uniform mat4 u_modelViewMatrix;
			uniform vec4 u_lightPosition;

			attribute vec4 a_position;
			attribute vec4 a_color;

			varying vec4 color;
			varying vec3 lightDir;
			varying vec3 viewDir;

			void main(){
				vec4 modelCameraPosition = u_modelViewMatrix * a_position;
        
				lightDir = vec3(u_lightPosition - modelCameraPosition);

				viewDir = vec3(-modelCameraPosition);
				gl_Position = u_modelViewProjectionMatrix * a_position;

				color = a_color;
			}
			
		</source>
	</vertexshader>
	
	<fragmentshader>
		<source>
			
			uniform vec4 u_materialSpecularColor;

			varying vec4 color;
			varying vec3 lightDir;
			varying vec3 viewDir;
			
			void main(){
      
        //float vd = 1.0 - abs(dot(N,V));
        //float ld = 1.0 - abs(dot(N,L));
        //float d = vd * ld;
        //d = d * d * d;
      
				//gl_FragColor = color * (1.0 - d) + u_materialSpecularColor * d;
				gl_FragColor = color;
			}

		</source>
	</fragmentshader>
</shader>
